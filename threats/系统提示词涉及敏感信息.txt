# 系统提示词涉及敏感信息

**威胁类别**：提示词 - 系统提示词缺陷  
**风险等级**：P1（高危）

## 1. 漏洞原理

### 1.1 敏感信息硬编码
系统提示词中包含企业敏感信息，如硬编码密钥、密码、API密钥、用户身份、个人交易数据等。

### 1.2 历史版本泄露风险
历史版本的系统提示词可能包含已删除但未彻底清理的敏感信息。

### 1.3 提示词泄露途径
- 通过提示词注入攻击获取系统提示词
- 代码仓库泄露
- 日志记录泄露
- 错误信息暴露

## 2. 漏洞危害

- **密钥泄露**：API密钥、数据库密码等直接暴露
- **身份信息泄露**：用户身份、权限配置等敏感数据泄露
- **业务逻辑泄露**：企业核心业务规则和配置暴露
- **合规风险**：违反数据保护法规（GDPR、个人信息保护法等）
- **供应链风险**：第三方服务凭证泄露导致供应链攻击

## 3. 修复方式

### 3.1 开发原则
- 系统提示词中不得包含任何硬编码的敏感信息
- 敏感配置通过环境变量或密钥管理系统注入
- 定期审查历史版本中的敏感信息
- 建立提示词安全审查机制

### 3.2 修复建议

#### 3.2.1 敏感信息隔离
- 使用环境变量或密钥管理服务（如AWS Secrets Manager、Azure Key Vault）
- 密钥和密码通过安全渠道动态获取
- 不在提示词中包含实际密钥值

#### 3.2.2 历史版本清理
- 定期审查Git历史记录中的敏感信息
- 使用git-filter-repo等工具清理历史敏感数据
- 建立提示词版本控制和审计机制

#### 3.2.3 访问控制
- 限制系统提示词的访问权限
- 实现基于角色的访问控制（RBAC）
- 提示词修改需要审批流程

#### 3.2.4 安全审查流程
- 提示词新增/修改时进行安全审查
- 使用自动化工具扫描敏感信息（如密钥、邮箱、手机号等）
- 建立敏感信息检测规则库

## 4. 触发场景

- 系统提示词新增
- 系统提示词修改

## 5. 检测方法

- 使用正则表达式检测常见密钥格式
- 扫描API密钥、密码等敏感字符串
- 审查历史Git提交记录
- 静态代码分析工具检测
