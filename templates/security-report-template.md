# AI应用安全评估报告

## 基本信息

| 项目 | 内容 |
|------|------|
| 评估对象 | [应用名称] |
| 应用类型 | [LLM应用/智能体/MCP服务/多模态应用] |
| 评估日期 | [日期] |
| 评估人员 | [评估人] |
| 报告版本 | V1.0 |

## 1. 执行摘要

### 1.1 评估范围
[描述本次安全评估的范围，包括评估的组件、功能模块、接口等]

### 1.2 应用架构概述
```
[简要描述应用架构，包括：
- 前端/后端架构
- 模型服务架构
- 智能体/MCP架构
- 数据流和交互流程]
```

### 1.3 风险概览

| 风险等级 | 数量 | 占比 |
|----------|------|------|
| P0 (严重) | 0 | 0% |
| P1 (高危) | 0 | 0% |
| P2 (中危) | 0 | 0% |
| **总计** | **0** | **100%** |

### 1.4 主要发现
[列出3-5个最重要的安全发现，按严重程度排序]

## 2. 威胁评估详情

### 2.1 提示词层安全

#### 检查项
- [ ] 系统提示词是否包含敏感信息（密钥、密码、API密钥等）
- [ ] 是否有提示词注入防护机制
- [ ] 提示词是否会在输出中泄露
- [ ] 日志中是否记录完整提示词
- [ ] 是否有提示词版本管理和访问控制

#### 发现问题
[描述发现的问题，包括具体的威胁类型和影响]

#### 风险等级
[P0/P1/P2]

#### 修复建议
[具体修复建议，参考相关威胁文档]

**相关威胁文档：**
- 系统提示词涉及敏感信息
- 提示词泄露与知识产权
- 单模态：文字交互提示词注入
- 多模态：间接提示词注入
- 多模态：ASCII走私

---

### 2.2 模型层安全

#### 2.2.1 模型越狱防护

**检查项：**
- [ ] 是否有混淆编码检测机制
- [ ] 是否有角色扮演检测和拒绝机制
- [ ] 是否有身份验证机制

**发现问题：**
[描述发现的问题]

**风险等级：** [P0/P1/P2]

**修复建议：**
[具体修复建议]

**相关威胁文档：** 混淆编码、角色扮演

---

#### 2.2.2 模型拒绝服务防护

**检查项：**
- [ ] 是否设置最大token限制
- [ ] 是否有并发控制机制
- [ ] 是否有资源配额管理
- [ ] 是否有熔断降级机制

**发现问题：**
[描述发现的问题]

**风险等级：** [P0/P1/P2]

**修复建议：**
[具体修复建议]

**相关威胁文档：** 模型长上下文控制缺失、模型的并发控制缺失、模型交互资源耗尽

---

#### 2.2.3 模型逻辑缺陷

**检查项：**
- [ ] 是否有渐进式攻击检测
- [ ] 是否有训练数据泄露防护
- [ ] 是否有恶意代码生成检测
- [ ] 是否有有害内容过滤
- [ ] 是否有事实性验证机制

**发现问题：**
[描述发现的问题]

**风险等级：** [P0/P1/P2]

**修复建议：**
[具体修复建议]

**相关威胁文档：** 渐进式攻击威胁、训练数据交互式获取、模型恶意代码内容生成、模型有害内容生成、模型幻觉与事实性错误

---

#### 2.2.4 模型操作执行安全

**检查项：**
- [ ] 模型输出是否为结构化格式
- [ ] 是否有命令执行隔离
- [ ] 是否有操作权限控制
- [ ] 高风险操作是否有二次确认

**发现问题：**
[描述发现的问题]

**风险等级：** [P0/P1/P2]

**修复建议：**
[具体修复建议]

**相关威胁文档：** 系统命令代码执行或其他恶意操作注入、恶意偏见决策执行

---

#### 2.2.5 模型特有攻击防护

**检查项：**
- [ ] 是否有对抗样本检测
- [ ] 模型来源是否可信
- [ ] 是否有后门检测机制
- [ ] 是否有模型逆向防护

**发现问题：**
[描述发现的问题]

**风险等级：** [P0/P1/P2]

**修复建议：**
[具体修复建议]

**相关威胁文档：** 对抗样本攻击、模型供应链攻击、模型逆向与隐私泄露

---

### 2.3 模型训练安全

#### 检查项
- [ ] 训练数据是否包含敏感信息
- [ ] 是否有数据脱敏和匿名化
- [ ] 是否有数据来源验证
- [ ] 是否有后门检测机制

#### 发现问题
[描述发现的问题]

#### 风险等级
[P0/P1/P2]

#### 修复建议
[具体修复建议]

**相关威胁文档：** 训练数据知识库数据范围控制缺失、训练数据投毒

---

### 2.4 智能体层安全

#### 2.4.1 MCP协议安全

**检查项：**
- [ ] MCP鉴权机制是否完善
- [ ] OAuth配置是否安全
- [ ] 是否存在令牌透传风险
- [ ] 会话管理是否安全

**发现问题：**
[描述发现的问题]

**风险等级：** [P0/P1/P2]

**修复建议：**
[具体修复建议]

**相关威胁文档：** MCP权限校验缺陷、混淆副手缺陷、令牌透传、会话劫持

---

#### 2.4.2 权限控制

**检查项：**
- [ ] API是否有权限验证
- [ ] 是否存在IDOR风险
- [ ] 是否有功能级权限控制
- [ ] 是否使用UUID而非自增ID

**发现问题：**
[描述发现的问题]

**风险等级：** [P0/P1/P2]

**修复建议：**
[具体修复建议]

**相关威胁文档：** 封装层API越权-IDOR、封装层服务未授权、封装层服务功能级别的越权

---

#### 2.4.3 传统Web安全

**检查项：**
- [ ] 是否有SQL注入风险
- [ ] 是否有XSS风险
- [ ] 前端是否泄露敏感信息
- [ ] 文件上传/下载/删除是否安全
- [ ] 是否存在路径遍历风险

**发现问题：**
[描述发现的问题]

**风险等级：** [P0/P1/P2]

**修复建议：**
[具体修复建议]

**相关威胁文档：** SQL注入、XSS跨站脚本、前端敏感信息泄露、任意文件上传、任意文件下载、任意文件删除、路径遍历

---

### 2.5 日志审计

#### 检查项
- [ ] 关键操作是否有日志记录
- [ ] 日志是否脱敏
- [ ] 日志是否有保护
- [ ] 是否有日志保留策略

#### 发现问题
[描述发现的问题]

#### 风险等级
[P0/P1/P2]

#### 修复建议
[具体修复建议]

**相关威胁文档：** 日志缺失风险

---

## 3. 修复优先级建议

### 3.1 立即修复 (P0 - 严重)
[列出需要立即修复的问题，包括：
- 威胁描述
- 影响范围
- 修复建议
- 预计修复时间]

### 3.2 近期修复 (P1 - 高危)
[列出需要近期修复的问题]

### 3.3 计划修复 (P2 - 中危)
[列出可以计划修复的问题]

## 4. 安全建议总结

### 4.1 架构层面
[从架构设计角度提出的安全建议]

### 4.2 开发层面
[从开发实践角度提出的安全建议]

### 4.3 运维层面
[从运维管理角度提出的安全建议]

## 5. 附录

### 5.1 参考威胁文档
[列出本次评估参考的所有威胁文档]

### 5.2 测试方法
[描述使用的测试方法，包括：
- 静态代码分析
- 动态安全测试
- 渗透测试
- 威胁建模等]

### 5.3 工具列表
[列出使用的安全工具，如：
- 代码扫描工具
- 安全测试工具
- 威胁建模工具等]

### 5.4 相关标准
[列出参考的安全标准和最佳实践，如：
- OWASP Top 10 for LLM
- NIST AI Risk Management Framework
- ISO/IEC 27001等]

---

**报告结束**

*本报告基于AI应用安全威胁知识库生成，包含37个威胁文档的详细分析。*
