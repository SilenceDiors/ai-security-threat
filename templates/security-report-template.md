# AI应用安全评估报告

## 基本信息

| 项目 | 内容 |
|------|------|
| 评估对象 | [应用名称] |
| 应用类型 | [LLM应用/智能体/MCP服务/多模态应用] |
| 评估日期 | [日期] |
| 评估人员 | [评估人] |
| 报告版本 | V1.0 |

## 1. 执行摘要

### 1.1 评估范围
[描述本次安全评估的范围，包括评估的组件、功能模块、接口等]

### 1.2 应用架构概述
```
[简要描述应用架构，包括：
- 前端/后端架构
- 模型服务架构
- 智能体/MCP架构
- 数据流和交互流程]
```

### 1.3 风险概览

| 风险等级 | 数量 | 占比 |
|----------|------|------|
| P0 (严重) | 0 | 0% |
| P1 (高危) | 0 | 0% |
| P2 (中危) | 0 | 0% |
| **总计** | **0** | **100%** |

### 1.4 主要发现
[列出3-5个最重要的安全发现，按严重程度排序]

## 2. 威胁评估详情

### 2.1 提示词层安全

#### 检查项
- [ ] 系统提示词是否包含敏感信息（密钥、密码、API密钥等）
- [ ] 系统提示词是否包含恶意指令（黄赌毒、代码执行等）
- [ ] 是否有提示词注入防护机制（过滤关键词、输入验证）
- [ ] 提示词是否会在输出中泄露
- [ ] 日志中是否记录完整提示词（建议脱敏）
- [ ] 是否有提示词版本管理和访问控制

#### 发现问题
[描述发现的问题，包括具体的威胁类型和影响]

#### 风险等级
[P0/P1/P2]

#### 修复建议
[具体修复建议，参考相关威胁文档]

**相关威胁文档：**
- 系统提示词涉及敏感信息 (P1)
- 系统提示词恶意指令 (P1)
- 单模态：文字交互提示词注入 (P0)
- 多模态：间接提示词注入 (P0)

---

### 2.2 模型层安全

#### 2.2.1 模型越狱防护

**检查项：**
- [ ] 是否有混淆编码检测机制（Base64、Unicode等）
- [ ] 是否有角色扮演检测和拒绝机制
- [ ] 是否有身份验证机制（用户身份绑定）
- [ ] 是否有渐进式攻击检测（多轮对话敏感度评分）
- [ ] 多模态场景是否有OCR内容安全过滤

**发现问题：**
[描述发现的问题]

**风险等级：** [P0/P1/P2]

**修复建议：**
[具体修复建议]

**相关威胁文档：** 
- 混淆编码攻击 (P1)
- 角色扮演攻击 (P1)
- 渐进式攻击威胁 (P2)
- 多模态：间接提示词注入 (P0)

---

#### 2.2.2 模型拒绝服务防护

**检查项：**
- [ ] 是否设置最大token限制（每次调用和每日配额）
- [ ] 是否有并发控制机制（API网关限流、分布式限流）
- [ ] 是否有资源配额管理（按用户维度）
- [ ] 是否有熔断降级机制
- [ ] 是否有异常流量告警

**发现问题：**
[描述发现的问题]

**风险等级：** [P0/P1/P2]

**修复建议：**
[具体修复建议]

**相关威胁文档：** 
- 模型的并发控制缺失 (P2)
- 模型交互资源耗尽 (P2)

---

#### 2.2.3 模型逻辑缺陷

**检查项：**
- [ ] 是否有训练数据泄露防护（输出过滤、反提取测试）
- [ ] 训练数据是否包含敏感信息（脱敏、隔离）
- [ ] 是否有数据来源验证和审计

**发现问题：**
[描述发现的问题]

**风险等级：** [P0/P1/P2]

**修复建议：**
[具体修复建议]

**相关威胁文档：** 
- 训练数据交互式获取 (P2)
- 训练数据知识库数据范围控制缺失 (P0)
- 训练数据投毒 (P1)

---

---

### 2.3 模型训练安全

#### 检查项
- [ ] 训练数据是否包含敏感信息（个人信息、企业机密等）
- [ ] 是否有数据脱敏和匿名化流程
- [ ] 是否有数据来源验证和白名单
- [ ] 是否有后门检测机制（异常模式扫描）
- [ ] 训练前后是否有基准测试验证

#### 发现问题
[描述发现的问题]

#### 风险等级
[P0/P1/P2]

#### 修复建议
[具体修复建议]

**相关威胁文档：** 
- 训练数据知识库数据范围控制缺失 (P0)
- 训练数据投毒 (P1)
- 训练数据交互式获取 (P2)

---

### 2.4 智能体层安全

#### 2.4.1 供应链与组件安全

**检查项：**
- [ ] 封装层三方组件是否存在已知漏洞（高危/严重）
- [ ] 是否使用安全的组件制品库
- [ ] 传递依赖版本是否进行安全查询
- [ ] 是否有组件版本管理和更新机制

**发现问题：**
[描述发现的问题]

**风险等级：** [P0/P1/P2]

**修复建议：**
[具体修复建议]

**相关威胁文档：** 
- 封装层组件漏洞 (P1)

---

#### 2.4.2 操作执行边界控制

**检查项：**
- [ ] 封装层tools是否有严格的边界控制
- [ ] 是否开启命令执行等高权限tools
- [ ] MCP服务的工具权限是否最小化
- [ ] 是否有工具调用审计

**发现问题：**
[描述发现的问题]

**风险等级：** [P0/P1/P2]

**修复建议：**
[具体修复建议]

**相关威胁文档：** 
- 封装层操作边界控制缺陷 (P0)

---

#### 2.4.3 MCP协议安全

**检查项：**
- [ ] MCP鉴权机制是否完善（令牌验证、授权逻辑）
- [ ] 是否存在权限校验缺陷（越权执行工具）
- [ ] 是否使用官方推荐的安全实现

**发现问题：**
[描述发现的问题]

**风险等级：** [P0/P1/P2]

**修复建议：**
[具体修复建议]

**相关威胁文档：** 
- MCP权限校验缺陷 (P0)

---

#### 2.4.4 权限控制

**检查项：**
- [ ] 所有API是否强制JWT/OAuth2认证
- [ ] 是否存在IDOR风险（ID遍历、猜测）
- [ ] 是否有功能级权限控制（RBAC）
- [ ] 是否使用UUID而非自增ID
- [ ] 高敏感功能是否有审批流程

**发现问题：**
[描述发现的问题]

**风险等级：** [P0/P1/P2]

**修复建议：**
[具体修复建议]

**相关威胁文档：** 
- 封装层服务未授权 (P0)
- 封装层API越权-IDOR (P1)
- 封装层服务功能级别的越权 (P1)

---

#### 2.4.5 代码执行安全

**检查项：**
- [ ] 是否存在SQL注入风险（使用ORM/参数化查询）
- [ ] 是否存在命令/代码执行风险（禁用exec/eval）
- [ ] 如需命令执行是否有白名单和参数校验
- [ ] 是否使用公司安全SDK（序列化/反序列化）

**发现问题：**
[描述发现的问题]

**风险等级：** [P0/P1/P2]

**修复建议：**
[具体修复建议]

**相关威胁文档：** 
- SQL注入 (P0)
- 命令/代码执行 (P0)

---

#### 2.4.6 Web安全与前端风险

**检查项：**
- [ ] 是否有XSS风险（输出编码、CSP头、DOMPurify）
- [ ] 前端是否泄露敏感信息（硬编码密钥、配置）
- [ ] 是否使用webpack DefinePlugin注入运行时配置

**发现问题：**
[描述发现的问题]

**风险等级：** [P0/P1/P2]

**修复建议：**
[具体修复建议]

**相关威胁文档：** 
- XSS跨站脚本 (P1)
- 前端敏感信息泄露 (P1)

---

#### 2.4.7 文件交互安全

**检查项：**
- [ ] 文件下载前是否校验用户权限和文件归属
- [ ] 是否存在路径遍历风险（路径规范化、白名单）
- [ ] 文件操作是否有审计日志
- [ ] 下载链接是否token化临时有效

**发现问题：**
[描述发现的问题]

**风险等级：** [P0/P1/P2]

**修复建议：**
[具体修复建议]

**相关威胁文档：** 
- 任意文件操作 (P1)
- 路径遍历 (P1)

---

### 2.5 日志审计安全

#### 检查项
- [ ] **日志记录完整性**
  - [ ] 用户查询/提问是否记录
  - [ ] 工具调用/操作执行是否记录
  - [ ] 提示词变更是否记录
  - [ ] 训练数据更新是否记录
  - [ ] 认证/授权事件是否记录
- [ ] **日志脱敏处理**
  - [ ] 是否记录密码/密钥/令牌
  - [ ] 是否记录个人敏感信息（身份证、手机号、银行卡）
  - [ ] 是否记录企业敏感信息（商业机密、财务数据）
  - [ ] 是否记录完整SQL语句（可能包含敏感数据）
- [ ] **日志安全保护**
  - [ ] 日志是否有写保护
  - [ ] 日志访问是否有权限控制
  - [ ] 是否有日志完整性校验（防篡改）
- [ ] **日志保留策略**
  - [ ] 是否有明确的保留时长
  - [ ] 是否符合合规要求（GDPR、网安法等）

#### 发现问题
[描述发现的问题]

#### 风险等级
[P0/P1/P2]

#### 修复建议
[具体修复建议]

**相关威胁文档：** 
- 日志缺失风险 (P2) - 缺少日志导致抗抵赖问题
- 敏感日志打印风险 (P1) - 日志中记录敏感信息导致泄露

---

## 3. 修复优先级建议

### 3.1 立即修复 (P0 - 严重)
[列出需要立即修复的问题，包括：
- 威胁描述
- 影响范围
- 修复建议
- 预计修复时间]

### 3.2 近期修复 (P1 - 高危)
[列出需要近期修复的问题]

### 3.3 计划修复 (P2 - 中危)
[列出可以计划修复的问题]

## 4. 安全建议总结

### 4.1 架构层面
[从架构设计角度提出的安全建议]

### 4.2 开发层面
[从开发实践角度提出的安全建议]

### 4.3 运维层面
[从运维管理角度提出的安全建议]

## 5. 附录

### 5.1 参考威胁文档
[列出本次评估参考的所有威胁文档]

### 5.2 测试方法
[描述使用的测试方法，包括：
- 静态代码分析
- 动态安全测试
- 渗透测试
- 威胁建模等]

### 5.3 工具列表
[列出使用的安全工具，如：
- 代码扫描工具
- 安全测试工具
- 威胁建模工具等]

### 5.4 相关标准
[列出参考的安全标准和最佳实践，如：
- OWASP Top 10 for LLM
- NIST AI Risk Management Framework
- ISO/IEC 27001等]

---

**报告结束**

*本报告基于AI应用安全威胁知识库生成，包含26个威胁文档的详细分析。*
